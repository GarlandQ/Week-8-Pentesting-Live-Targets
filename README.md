# Project 8 - Pentesting Live Targets

Time spent: **8** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

Vulnerability #1: SQL Injection
  - [ ] Steps to recreate:
    - From the home page, click on "Find a Salesperson"
    - Click on any one of the salespeople and input `' OR SLEEP(3) = 0--'` OR `' OR '1'='1 ` at the end of the URL (The function SLEEP() ensures that our injection is working properly by waiting, whereas the second injection does it almost instantly.)
    - The page should load and you will now have a different salesperson (Daron Burke in this case).
  - [ ] GIF Walkthrough:
    - <img src="bluesqlinjection.gif" width="800">

Vulnerability #2: Session Hijacking/Fixation
  - [ ] Steps to recreate:
    - On one browser, log in as admin to the page.
    - Using the hack tool provided (hacktools/change_session_id.php), copy the PHPSESSIONID from the browser the admin logged in with.
    - On another browser, using the same hack tool, change your current session into the same PHPSESSIONID as the admin.
    - The admin privileges should be accessible to the second browser now without having to enter any credentials.
  - [ ] GIF Walkthrough:
    - <img src="bluesessionhijack.gif" width="800">

## Green

Vulnerability #1: Username Enumeration
  - [ ] Steps to recreate:
    - When trying to log into the admin page, input any username that is NOT "jmonroe99" and input a random password.
    - When inspecting the element on the page, specifically "Log in was unsuccessful", the span class is declared "failed".
    - Try using "jmonroe99" this time and a random password.
    - You will notice the "Log in was unsuccessful" message is now bold and the span class is declared "failure" instead of "failed".
  - [ ] GIF Walkthrough:
    - <img src="greenuserenumeration.gif" width="800">

Vulnerability #2: Cross Site Scripting
  - [ ] Steps to recreate:
    - From the home page, click on the "Contact" tab.
    - Enter any name and email, and on the feedback box, enter the script. In this case: `<script>alert('Garland found the XSS!');</script>`
    - From another browser, access the admin page and look for your feedback.
    - The script should have started after checking the feedback page.
  - [ ] GIF Walkthrough:
    - <img src="greenxss.gif" width="800">

## Red

Vulnerability #1: Cross-Site Request Forgery
  - [ ] Steps to recreate:
    - As an admin, access the salespeople menu and click on any salesperson and click edit. (In my case, I will be bullying Irene Boling and changing her info.)
    - Next, inspect the element and we will notice that this is a POST method and by copying and pasting some of the HTML code and making some new ones, we can get an attack form as such:
      ```
      <html>
        <body onload="document.hiddenForm.submit()">
          <form name="hiddenForm" style="display:none" action="https://35.184.88.145/red/public/staff/salespeople/edit.php?id=3" target="target" method="post">
            <input type="text" name="first_name" value="Loser Irene" />
            <input type="text" name="last_name" value="Boling MORE LIKE BOWLING GOTTEM" />
            <input type="text" name="phone" value="999-999-9999" />
            <input type="text" name="email" value="IBOWLING@LAMEsalesperson.com" />
          </form>
          <iframe name="target" style="display:none" ></iframe>
        </body>
      </html>```
    - Save the attack form into your directory, as it will be used to change our target's information.
    - Afterwards, we go back to the public site and contact the company.
    - Enter a name and email and paste your HTML attack form's directory into the feedback box.
    - Send the submission and go back to the admin page.
    - As an admin, open the HTML on another tab and when you go back into the salespeople list, the target's info has been changed.
    A few notes:
      - Obviously, this HTML link is locally stored, and if people try to access the link from different computers, it will not work. One way to bypass this is to create a local hosting of the HTML and then start a web server with it. (Python has a built in local host and using localtunnel (https://localtunnel.github.io/www/), the HTML can be public as long as your machine is active.)

  - [ ] GIF Walkthrough:
    - <img src="redcsrf.gif" width="800">

Vulnerability #2: Insecure Direct Object Reference
  - [ ] Steps to recreate:
    - As a guest visiting the site, click on "Find a Salesperson" and click any person.
    - You will notice each salesperson has a unique ID and as you keep incrementing that ID number, you will notice the other staff members of the company.
    - If you visit ID 10 and 11, you will see information you were not suppose to see as a guest. (What the other sites did was censor this information by redirecting you back to the list.)
  - [ ] GIF Walkthrough:
    - <img src="redIDOR.gif" width="800">


## Notes

Describe any challenges encountered while doing the work.
A lot of the challenges has to do with a bunch of trial and error. For each site, I had to test every possible exploit and some were not as obvious.
The most challenging part was for sure the red website's CSRF, from just formatting the HTML to sending it to the admin to click on (or in my case, copy and paste into the address bar).
